# DCO Analytics Repository

[![Wiki.js](https://img.shields.io/badge/Platform-Wiki.js-green.svg)](https://js.wiki/)
[![Threat Intelligence](https://img.shields.io/badge/Type-Threat%20Intelligence-red.svg)](https://attack.mitre.org/)

> **Defense Cyber Operations (DCO) Analytics Repository** - A comprehensive collection of threat intelligence, detection rules, and hunting methodologies for advanced persistent threat (APT) actors and malware families.

## üéØ Overview

This repository serves as a centralized knowledge base for cybersecurity professionals, providing actionable intelligence and detection capabilities for sophisticated threat actors including **Bazooka Tiger**, **Shotgun Tiger**, and **Steel Stoat**. The repository is designed to be deployed with Wiki.js for interactive documentation and analytics.

## üèóÔ∏è Complete Repository Structure

```
wikijs-dco-analytics/
‚îú‚îÄ‚îÄ üìÅ Artifacts/                    # Security tool artifacts and configurations
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Elastic Kibana/          # Kibana dashboards and queries
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Dashboards/          # Dashboard configurations
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Queries/             # Elasticsearch queries
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Splunk/                  # Splunk dashboards and queries
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Dashboards/          # Dashboard configurations
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Queries/             # SPL queries
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Suricata/                # Suricata rules and configurations
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Sysmon/                  # Sysmon configurations and rules
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ YARA/                    # YARA rules for malware detection
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Zeek/                    # Zeek scripts and configurations
‚îú‚îÄ‚îÄ üìÅ Detections/                  # Detection rules and dashboards
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Dashboards/              # Splunk dashboards for APT hunting
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Host/                    # Host-based detection rules
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Windows/             # Windows host detection rules
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Network/                 # Network detection rules (Suricata)
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ TA0001-TA0011/           # MITRE ATT&CK technique-based detections
‚îú‚îÄ‚îÄ üìÅ Hunt_Playbooks/              # Threat hunting methodologies
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Active-Mission/          # Current hunting operations
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Pre-Mission/             # Pre-mission planning materials
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Post-Mission/            # Post-mission analysis and reporting
‚îú‚îÄ‚îÄ üìÅ IOCs/                        # Indicators of Compromise
‚îú‚îÄ‚îÄ üìÅ Malware_Tools/               # Malware analysis and tools
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Malware/                 # Malware family analysis
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Tools/                   # Attack tool analysis
‚îú‚îÄ‚îÄ üìÅ Reference/                   # Reference materials and mappings
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ MITRE_Mappings/          # MITRE ATT&CK technique mappings
‚îú‚îÄ‚îÄ üìÅ Repository_Data/             # Supporting datasets and materials
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ datasets/                # Training and testing datasets
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ images/                  # Screenshots and visual materials
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ misc/                    # Miscellaneous supporting files
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ pcaps/                   # Network packet captures
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ pdfs/                    # PDF documents and reports
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ suricata/                # Suricata rule files
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ yara/                    # YARA rule files
‚îú‚îÄ‚îÄ üìÅ Threat_Intelligence/         # Threat actor profiles and intelligence
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Actors/                  # APT group profiles
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Campaigns/                # Campaign intelligence
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Clusters/                # Threat cluster intelligence
‚îú‚îÄ‚îÄ üìÅ Validation/                  # Validation materials and testing
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Datasets/                # Validation datasets
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Sample Data/             # Sample data for testing
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Unit Tests/              # Unit tests for components
‚îú‚îÄ‚îÄ üìÅ home/                        # Wiki.js homepage content
‚îÇ   ‚îî‚îÄ‚îÄ index.md                    # Homepage template for Wiki.js instance
‚îî‚îÄ‚îÄ docker-compose.yml              # Docker deployment configuration
```

## üöÄ Wiki.js Deployment

### Deployment Options

#### Option 0: Docker Deployment (Recommended for Quick Setup)
1. **Prerequisites**: Install Docker and Docker Compose on your system
2. **Clone Repository**: Clone this repository to your local system
3. **Configure Environment**: Create a `.env` file in the repository root with your custom settings:
   ```bash
   # Copy the template and customize
   cp env.template .env
   # Edit the .env file with your preferred settings
   nano .env
   ```
   
   The template includes all available configuration options with sensible defaults.
4. **Configure Data Directory**: Create and configure the data directory:
   ```bash
   # Create data directory and set proper ownership
   mkdir -p ./wiki-data
   # Set ownership to match your user (replace 1000:1000 with your UID:GID)
   sudo chown -R $(id -u):$(id -g) ./wiki-data
   ```
5. **Deploy with Docker Compose**: 
   ```bash
   docker-compose up -d
   ```
6. **Access Wiki.js**: Navigate to `http://localhost` (or your configured port) in your browser
7. **Set Homepage**: When creating the homepage, choose "Choose from template" and navigate to `home/` to select `index.md` as the homepage template
8. **Configure Git Sync**: Set up Git Sync to point to this repository for content synchronization

> **Important**: The data folder created by Docker may have permission issues. You'll need to ensure the ownership matches your user configuration (USER_ID:GROUP_ID) to avoid permission issues when Wiki.js tries to create necessary directories.

### Docker Compose Configuration

The included `docker-compose.yml` file provides a complete Wiki.js deployment with:

- **PostgreSQL Database**: Pre-configured PostgreSQL 16 instance with health checks
- **Wiki.js Application**: Latest Wiki.js v2 with proper database connectivity
- **Volume Management**: Persistent data storage for both database and Wiki.js
- **User Permissions**: Configurable user permissions via environment variables
- **Timezone Support**: Configurable timezone (defaults to America/New_York)
- **Port Mapping**: Configurable port mapping (defaults to port 80)

The configuration includes proper health checks to ensure the database is ready before Wiki.js starts, and all necessary environment variables for seamless connectivity. All paths, usernames, and configurations can be customized via environment variables or a `.env` file.

### Environment Configuration

The Docker Compose setup supports the following environment variables:

| Variable | Default | Description |
|----------|---------|-------------|
| `POSTGRES_DB` | `wiki` | PostgreSQL database name |
| `POSTGRES_USER` | `wikijs` | PostgreSQL username |
| `POSTGRES_PASSWORD` | `wikijs` | PostgreSQL password |
| `WIKI_PORT` | `80` | Port for Wiki.js web interface |
| `WIKI_DATA_PATH` | `./wiki-data` | Local path for Wiki.js data |
| `USER_ID` | `1000` | User ID for container permissions |
| `GROUP_ID` | `1000` | Group ID for container permissions |
| `TZ` | `America/New_York` | Timezone configuration |

#### Option 1: Git Sync (Recommended for Collaborative Editing)
1. **Install Wiki.js** on your server
2. **Configure Database**: Set up PostgreSQL database for enhanced search capabilities
3. **Configure Git Sync** in Wiki.js settings:
   - Set repository URL to this GitHub repository
   - Enable bidirectional sync for collaborative editing
   - Configure authentication if needed
4. **Set Homepage**: When creating the homepage in Wiki.js, choose "Choose from template" and navigate to `home/` to select `index.md` as the homepage template
5. **Configure Storage**: Set up local file system storage for Wiki.js data

#### Option 2: Local File System Hosting
1. **Install Wiki.js** on your server
2. **Configure Database**: Set up PostgreSQL database for enhanced search capabilities
3. **Clone Repository** to your local file system
4. **Configure Wiki.js** to use local file system storage
5. **Set Homepage**: When creating the homepage in Wiki.js, choose "Choose from template" and navigate to `home/` to select `index.md` as the homepage template

### For Analysts
1. **Start with Hunt Playbooks** - Review active mission reports
2. **Deploy Detection Rules** - Import Suricata rules and Splunk dashboards  
3. **Use Reference Materials** - Consult MITRE mappings and actor profiles
4. **Monitor Dashboards** - Set up real-time monitoring with provided dashboards

### For Administrators
1. **Configure Wiki.js** - Set up proper authentication and permissions
2. **Manage Configuration** - Handle content synchronization and system configuration
3. **Account Management** - Manage user accounts and access controls
4. **Content Management** - Update and maintain repository content

## üìä Key Features

### üé≠ Threat Actor Coverage
- **Bazooka Tiger** - Critical infrastructure targeting
- **Shotgun Tiger** - Maritime and logistics targeting  
- **Steel Stoat** - Cryptocurrency and financial targeting

### üõ°Ô∏è Detection Capabilities
- **Network Detection** - Suricata rules for network monitoring
- **Host Detection** - Windows event log analysis
- **SIEM Integration** - Splunk dashboards and queries
- **Cloud Support** - KQL queries for Microsoft Sentinel

### ü¶† Malware Analysis
- **15+ Malware Families** - Comprehensive analysis
- **Custom Tools** - Attack tool documentation
- **IOCs** - Indicators of compromise

## üìö Navigation Guide

### üèπ Hunt Playbooks
- **[Bazooka Tiger Hunt Report](Hunt_Playbooks/Active-Mission/Bazooka_Tiger/Hunt_Report.md)** - Complete hunting guide for BT activities
- **[Shotgun Tiger Hunt Report](Hunt_Playbooks/Active-Mission/Shotgun_Tiger/Hunt_Report.md)** - Maritime and logistics targeting detection
- **[Steel Stoat Hunt Report](Hunt_Playbooks/Active-Mission/Steel_Stoat/Hunt_Report.md)** - North Korean threat actor hunting

### üõ°Ô∏è Detections
- **[Network Detections](Detections/Network/)** - Suricata rules for network traffic analysis
- **[Host Detections](Detections/Host/)** - Windows host-based detection rules
- **[Dashboards](Detections/Dashboards/)** - Splunk dashboards for APT hunting

### ü¶† Malware & Tools
- **[Malware Families](Malware_Tools/Malware/)** - In-depth analysis of APT malware
- **[Tools](Malware_Tools/Tools/)** - Analysis of commonly used attack tools

### üé≠ Threat Intelligence
- **[Threat Actors](Threat_Intelligence/Actors/)** - Detailed profiles of APT groups

### üìñ Reference Materials
- **[MITRE Mappings](Reference/MITRE_Mappings/)** - MITRE ATT&CK technique mappings
- **[Generic References](Reference/)** - General reference materials

## üõ†Ô∏è Tools & Technologies

### Detection Platforms
- **Suricata** - Network intrusion detection
- **Splunk** - Security information and event management
- **Microsoft Sentinel** - Cloud-native SIEM
- **Windows Event Logs** - Host-based detection

### Analysis Tools
- **YARA** - Malware detection rules
- **MITRE ATT&CK** - Threat modeling framework
- **MISP** - Threat intelligence sharing

## üìà Repository Statistics

- **Threat Actors**: 3 major APT groups
- **Malware Families**: 15+ analyzed malware families
- **Detection Rules**: 50+ Suricata rules
- **Hunting Queries**: 30+ Splunk and KQL queries
- **MITRE Techniques**: 100+ mapped techniques

## üîß Wiki.js Integration

> **Note**: The `home/index.md` file serves as the homepage template for the Wiki.js instance. This repository is designed to be deployed with Wiki.js using Git Sync functionality, allowing for real-time updates and collaborative editing.

### Setup Instructions
1. **Install Wiki.js** on your server
2. **Configure Git Sync** to point to this repository
3. **Set Homepage**: When creating the homepage, choose "Choose from template" and navigate to `home/` to select `index.md` as the homepage template
4. **Enable Auto-sync** for real-time updates

## ü§ù Contributing

This repository is designed to be a living document that evolves with the threat landscape. Contributions are welcome in the following areas:
- New threat actor profiles
- Additional detection rules
- Enhanced hunting methodologies
- Updated IOCs and TTPs

> **Security Notice**: This repository contains sensitive threat intelligence. Please ensure proper handling and distribution controls are in place before sharing.
