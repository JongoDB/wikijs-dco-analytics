---
title: Scanbox
type: malware
importable: true
exportable: true
last_reviewed: 2025-01-20
mitre_ids: ["T1071", "T1071.001", "T1071.004", "T1218.011", "T1547", "T1560", "T1573"]
---

# Scanbox

## Overview

Scanbox is a sophisticated web profiling framework used by threat actors to gather intelligence about target organizations. This tool is designed to collect information about web browsers, operating systems, and other system characteristics to aid in targeted attacks.

## Observed Behavior & Capabilities

### Primary Functions
- **Web Profiling**: Collects information about web browsers and operating systems
- **Target Intelligence**: Gathers intelligence about target organizations
- **Reconnaissance**: Performs reconnaissance activities on target systems
- **Information Gathering**: Collects various system and network information

### Key Capabilities
- **Browser Fingerprinting**: Identifies browser types and versions
- **OS Detection**: Detects operating system types and versions
- **Network Profiling**: Gathers network-related information
- **Target Intelligence**: Collects information about target organizations

## Technical Details

### Architecture
- **Type**: Web Profiling Framework
- **Platform**: Web-based systems
- **Communication**: HTTP/HTTPS for communication
- **Persistence**: Various persistence mechanisms including web server configuration

### Network Behavior
- **Protocols**: HTTP/HTTPS for communication
- **Encryption**: May use encryption for communications
- **Beaconing**: Regular beaconing to C2 infrastructure
- **Data Collection**: Uses C2 channel for data collection

## Detection Methods

### Network Detection
```suricata
# Scanbox C2 Communication
alert tcp any any -> any any (msg:"Scanbox - C2 Communication"; content:"|SCANBOX_MAGIC_STRING|"; flow:established,to_server; sid:2025104043; rev:1;)

# Scanbox HTTP C2
alert http any any -> any any (msg:"Scanbox - HTTP C2 Communication"; http_uri; content:"/c2"; sid:2025104044; rev:1;)

# Scanbox DNS C2
alert dns any any -> any 53 (msg:"Scanbox - DNS C2 Communication"; dns_query; content:"suspicious_domain"; sid:2025104045; rev:1;)
```

### Host Detection
```powershell
# Scanbox process detection
Get-Process | Where-Object {$_.ProcessName -match "scanbox" -or $_.CommandLine -match "scanbox"}

# Suspicious service creation
Get-Service | Where-Object {$_.Name -match "scanbox" -or $_.DisplayName -match "scanbox"}
```

### Behavioral Indicators
- **Network Connections**: Unusual outbound HTTP/HTTPS connections
- **Process Creation**: Suspicious process creation patterns
- **Registry Modifications**: Unusual registry modifications
- **File System Changes**: Suspicious file creation and modification

## Hunting Queries

### Splunk Searches
```splunk
# Scanbox network activity
index=network* (url="*c2*" OR url="*scanbox*") OR (user_agent="*scanbox*")
| stats count by src_ip, dest_ip, url, user_agent

# Scanbox process activity
index=sysmon* EventCode=1 (Image="*scanbox*" OR CommandLine="*scanbox*")
| stats count by host, user, Image, CommandLine
```

### KQL Queries
```kql
// Scanbox network detection
DeviceNetworkEvents
| where RemoteUrl contains "scanbox" or RemoteUrl contains "c2"
| project Timestamp, DeviceName, RemoteUrl, InitiatingProcessFileName

// Scanbox process detection
DeviceProcessEvents
| where ProcessCommandLine contains "scanbox" or FileName contains "scanbox"
| project Timestamp, DeviceName, FileName, ProcessCommandLine
```

## IOCs (Indicators of Compromise)

### File Indicators
- **File Names**: [Known Scanbox file names from threat intelligence]
- **File Hashes**: [Known Scanbox file hashes from threat intelligence]
- **File Locations**: [Known Scanbox file locations from threat intelligence]

### Network Indicators
- **C2 Domains**: [Known C2 domains from threat intelligence]
- **IP Addresses**: [Known C2 IP addresses]
- **Ports**: 80, 443 (HTTP/HTTPS)

### Behavioral Indicators
- **Process Names**: Suspicious process names
- **Registry Keys**: Unusual registry modifications
- **File Paths**: Suspicious file creation patterns

## Mitigation Strategies

### Prevention
- **Endpoint Protection**: Deploy EDR solutions with web profiling detection
- **Network Monitoring**: Monitor for suspicious network connections
- **Access Controls**: Implement strict access controls
- **Patch Management**: Keep systems updated with latest security patches

### Detection
- **Network Monitoring**: Monitor for suspicious HTTP/HTTPS traffic
- **Process Monitoring**: Monitor for suspicious process creation
- **Registry Monitoring**: Monitor for suspicious registry modifications
- **File System Monitoring**: Monitor for suspicious file operations

### Response
- **Incident Response**: Have procedures for web profiling incidents
- **Forensic Analysis**: Preserve evidence for investigation
- **System Recovery**: Use clean backups for system recovery
- **Credential Rotation**: Rotate potentially compromised credentials

## Related MITRE ATT&CK Techniques

| Technique | Description | Tactic |
|-----------|-------------|---------|
| T1071 | Application Layer Protocol | Command and Control |
| T1071.001 | Application Layer Protocol: Web Protocols | Command and Control |
| T1071.004 | Application Layer Protocol: DNS | Command and Control |
| T1218.011 | Signed Binary Proxy Execution: Rundll32 | Defense Evasion |
| T1547 | Boot or Logon Autostart Execution | Persistence |
| T1560 | Archive Collected Data | Collection |
| T1573 | Encrypted Channel | Command and Control |

## References

- [CISA Alert - Web Profiling Threats](https://www.cisa.gov/news-events/cybersecurity-advisories/)
- [MITRE ATT&CK - Scanbox](https://attack.mitre.org/software/)
- [FBI Guidance - Web Profiling Threats](https://www.fbi.gov/)