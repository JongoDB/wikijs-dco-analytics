---
title: AuditCred
type: malware
importable: true
exportable: true
last_reviewed: 2025-01-20
mitre_ids: ["T1003", "T1003.001"]
---

# AuditCred

## Overview

AuditCred is a credential harvesting malware that targets Windows systems to extract authentication credentials and sensitive information. It is commonly associated with advanced persistent threat (APT) groups and is often used in conjunction with other malware families.

## Observed Behavior & Capabilities

### Primary Functions
- **Credential Harvesting**: Extracts stored credentials from various sources
- **SAM Database Access**: Attempts to access Security Account Manager database
- **LSASS Memory Access**: Targets Local Security Authority Subsystem Service
- **Token Impersonation**: May attempt to impersonate user tokens

### Associated Malware
AuditCred is often found alongside other credential harvesting tools such as:
- Mimikatz
- DUCKFAT
- Various RAT families

## Technical Details

### Target Systems
- **Operating System**: Windows-based systems
- **Architecture**: Both 32-bit and 64-bit systems
- **Privileges**: Typically requires elevated privileges for full functionality

### Persistence Mechanisms
- **Registry Keys**: May create registry entries for persistence
- **Service Installation**: Could install as a Windows service
- **Scheduled Tasks**: May use scheduled tasks for execution

## Detection Methods

### Network Detection
```suricata
alert tcp any any -> any any (msg:"AuditCred - Potential Credential Harvesting"; content:"|LSASS|"; flow:established,to_server; sid:2025100602; rev:1;)
```

### Host Detection
```powershell
# PowerShell detection for LSASS access attempts
Get-Process -Name "lsass" | Get-NetTCPConnection | Where-Object {$_.State -eq "Established"}
```

### Behavioral Indicators
- **Process Monitoring**: Look for processes attempting to access LSASS
- **Registry Monitoring**: Monitor for suspicious registry modifications
- **File System**: Check for unusual files in system directories

## Hunting Queries

### Splunk Search
```splunk
index=wineventlog* (EventCode=4656 OR EventCode=4663) (ObjectName="*SAM*" OR ObjectName="*LSASS*")
| stats count by host, user, ObjectName, ProcessName
```

### KQL Query
```kql
DeviceProcessEvents
| where ProcessCommandLine contains "lsass" or ProcessCommandLine contains "sam"
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
```

## Mitigation Strategies

### Prevention
- **Credential Protection**: Implement Credential Guard on Windows 10/11
- **LSASS Protection**: Enable LSASS protection features
- **Privilege Management**: Implement least privilege access principles
- **Network Segmentation**: Isolate critical systems

### Detection
- **Endpoint Protection**: Deploy EDR solutions with credential theft detection
- **Log Monitoring**: Monitor Windows security logs for suspicious access
- **Memory Protection**: Use tools like Microsoft Defender for Endpoint

### Response
- **Incident Response**: Have procedures for credential compromise incidents
- **Credential Rotation**: Implement credential rotation policies
- **Forensic Analysis**: Preserve evidence for investigation

## Related MITRE ATT&CK Techniques

| Technique | Description | Tactic |
|-----------|-------------|---------|
| T1003 | OS Credential Dumping | Credential Access |
| T1003.001 | OS Credential Dumping: LSASS Memory | Credential Access |

## References

- [MITRE ATT&CK - OS Credential Dumping](https://attack.mitre.org/techniques/T1003/)
- [Microsoft Security Blog - Protecting LSASS](https://www.microsoft.com/security/blog/)
- [CISA Alert - Credential Harvesting Techniques](https://www.cisa.gov/news-events/cybersecurity-advisories/)
