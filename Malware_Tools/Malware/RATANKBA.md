---
title: RATANKBA
type: malware
importable: true
exportable: true
last_reviewed: 2025-01-20
mitre_ids: ["T1012", "T1059.003", "T1071", "T1071.001"]
---

# RATANKBA

## Overview

RATANKBA is a sophisticated remote access trojan (RAT) associated with North Korean state-sponsored threat actors. This malware is designed to provide persistent access to compromised systems and enable various post-exploitation activities including data theft, system reconnaissance, and lateral movement.

## Observed Behavior & Capabilities

### Primary Functions
- **Remote Access**: Provides persistent remote access to compromised systems
- **System Reconnaissance**: Gathers information about the target environment
- **Command Execution**: Executes commands and scripts on the target system
- **Data Exfiltration**: Steals sensitive data from compromised systems

### Key Capabilities
- **Persistent Backdoor**: Establishes long-term access to compromised systems
- **Command and Control**: Communicates with C2 infrastructure
- **System Information Gathering**: Collects system and network information
- **File Operations**: Performs file system operations for data theft

## Technical Details

### Architecture
- **Type**: Remote Access Trojan (RAT)
- **Platform**: Windows-based systems
- **Communication**: HTTP/HTTPS-based C2 communication
- **Persistence**: Various persistence mechanisms including registry and service installation

### Network Behavior
- **Protocol**: HTTP/HTTPS for C2 communication
- **Encryption**: May use encryption for C2 communications
- **Beaconing**: Regular beaconing to C2 infrastructure
- **Data Exfiltration**: Uses C2 channel for data theft

## Detection Methods

### Network Detection
```suricata
# RATANKBA C2 Communication
alert tcp any any -> any any (msg:"RATANKBA - C2 Communication"; content:"|52 41 54 41 4E 4B 42 41|"; flow:established,to_server; sid:2025104003; rev:1;)

# RATANKBA HTTP C2
alert http any any -> any any (msg:"RATANKBA - HTTP C2 Communication"; http_uri; content:"/c2"; sid:2025104004; rev:1;)
```

### Host Detection
```powershell
# RATANKBA process detection
Get-Process | Where-Object {$_.ProcessName -match "ratankba" -or $_.CommandLine -match "ratankba"}

# Suspicious service creation
Get-Service | Where-Object {$_.Name -match "ratankba" -or $_.DisplayName -match "ratankba"}
```

### Behavioral Indicators
- **Network Connections**: Unusual outbound HTTP/HTTPS connections
- **Process Creation**: Suspicious process creation patterns
- **Registry Modifications**: Unusual registry modifications
- **File System Changes**: Suspicious file creation and modification

## Hunting Queries

### Splunk Searches
```splunk
# RATANKBA network activity
index=network* (url="*c2*" OR url="*ratankba*") OR (user_agent="*ratankba*")
| stats count by src_ip, dest_ip, url, user_agent

# RATANKBA process activity
index=sysmon* EventCode=1 (Image="*ratankba*" OR CommandLine="*ratankba*")
| stats count by host, user, Image, CommandLine
```

### KQL Queries
```kql
// RATANKBA network detection
DeviceNetworkEvents
| where RemoteUrl contains "c2" or RemoteUrl contains "ratankba"
| project Timestamp, DeviceName, RemoteUrl, InitiatingProcessFileName

// RATANKBA process detection
DeviceProcessEvents
| where ProcessCommandLine contains "ratankba" or FileName contains "ratankba"
| project Timestamp, DeviceName, FileName, ProcessCommandLine
```

## IOCs (Indicators of Compromise)

### File Hashes
- **MD5**: cb52c013f7af0219d45953bae663c9a2
- **SHA-1**: [Multiple SHA-1 hashes available in threat intelligence feeds]
- **SHA-256**: [Multiple SHA-256 hashes available in threat intelligence feeds]

### Network Indicators
- **C2 Domains**: [Known C2 domains from threat intelligence]
- **IP Addresses**: [Known C2 IP addresses]
- **Ports**: 80, 443 (HTTP/HTTPS)

### Behavioral Indicators
- **Process Names**: Suspicious process names
- **Registry Keys**: Unusual registry modifications
- **File Paths**: Suspicious file creation patterns

## Mitigation Strategies

### Prevention
- **Endpoint Protection**: Deploy EDR solutions with RAT detection
- **Network Monitoring**: Monitor for suspicious network connections
- **Access Controls**: Implement strict access controls
- **Patch Management**: Keep systems updated with latest security patches

### Detection
- **Network Monitoring**: Monitor for suspicious HTTP/HTTPS traffic
- **Process Monitoring**: Monitor for suspicious process creation
- **Registry Monitoring**: Monitor for suspicious registry modifications
- **File System Monitoring**: Monitor for suspicious file operations

### Response
- **Incident Response**: Have procedures for RAT incidents
- **Forensic Analysis**: Preserve evidence for investigation
- **System Recovery**: Use clean backups for system recovery
- **Credential Rotation**: Rotate potentially compromised credentials

## Related MITRE ATT&CK Techniques

| Technique | Description | Tactic |
|-----------|-------------|---------|
| T1012 | Query Registry | Discovery |
| T1059.003 | Command and Scripting Interpreter: Windows Command Shell | Execution |
| T1071 | Application Layer Protocol | Command and Control |
| T1071.001 | Application Layer Protocol: Web Protocols | Command and Control |

## References

- [CISA Alert - North Korean State-Sponsored Threats](https://www.cisa.gov/news-events/cybersecurity-advisories/)
- [MITRE ATT&CK - RATANKBA](https://attack.mitre.org/software/)
- [FBI Guidance - North Korean Cyber Threats](https://www.fbi.gov/)
