---
title: Tomcat Backdoor
type: malware
importable: true
exportable: true
last_reviewed: 2025-01-20
mitre_ids: ["T1055.001", "T1071", "T1071.001", "T1071.004", "T1218.011", "T1547", "T1560", "T1573"]
---

# Tomcat Backdoor

## Overview

Tomcat Backdoor is a sophisticated web shell backdoor designed to exploit Apache Tomcat servers. This malware is designed to provide persistent access to compromised web servers and enable various post-exploitation activities including data theft, system reconnaissance, and lateral movement.

## Observed Behavior & Capabilities

### Primary Functions
- **Web Shell Access**: Provides persistent web-based access to compromised servers
- **System Reconnaissance**: Gathers information about the target environment
- **Command Execution**: Executes commands and scripts on the target system
- **Data Exfiltration**: Steals sensitive data from compromised systems

### Key Capabilities
- **HTTP-Based**: Uses HTTP/HTTPS for communication
- **Web Server Integration**: Integrates with Apache Tomcat web servers
- **Command and Control**: Communicates with C2 infrastructure
- **System Information Gathering**: Collects system and network information

## Technical Details

### Architecture
- **Type**: Web Shell Backdoor
- **Platform**: Apache Tomcat web servers
- **Communication**: HTTP/HTTPS for C2 communication
- **Persistence**: Various persistence mechanisms including web server configuration

### Network Behavior
- **Protocols**: HTTP/HTTPS for C2 communication
- **Encryption**: May use encryption for C2 communications
- **Beaconing**: Regular beaconing to C2 infrastructure
- **Data Exfiltration**: Uses C2 channel for data theft

## Detection Methods

### Network Detection
```suricata
# Tomcat Backdoor C2 Communication
alert tcp any any -> any any (msg:"Tomcat Backdoor - C2 Communication"; content:"|TOMCAT_BACKDOOR_MAGIC_STRING|"; flow:established,to_server; sid:2025104040; rev:1;)

# Tomcat Backdoor HTTP C2
alert http any any -> any any (msg:"Tomcat Backdoor - HTTP C2 Communication"; http_uri; content:"/c2"; sid:2025104041; rev:1;)

# Tomcat Backdoor DNS C2
alert dns any any -> any 53 (msg:"Tomcat Backdoor - DNS C2 Communication"; dns_query; content:"suspicious_domain"; sid:2025104042; rev:1;)
```

### Host Detection
```powershell
# Tomcat Backdoor process detection
Get-Process | Where-Object {$_.ProcessName -match "tomcat" -or $_.CommandLine -match "tomcat"}

# Suspicious service creation
Get-Service | Where-Object {$_.Name -match "tomcat" -or $_.DisplayName -match "tomcat"}
```

### Behavioral Indicators
- **Network Connections**: Unusual outbound HTTP/HTTPS connections
- **Process Creation**: Suspicious process creation patterns
- **Registry Modifications**: Unusual registry modifications
- **File System Changes**: Suspicious file creation and modification

## Hunting Queries

### Splunk Searches
```splunk
# Tomcat Backdoor network activity
index=network* (url="*c2*" OR url="*tomcat*") OR (user_agent="*tomcat*")
| stats count by src_ip, dest_ip, url, user_agent

# Tomcat Backdoor process activity
index=sysmon* EventCode=1 (Image="*tomcat*" OR CommandLine="*tomcat*")
| stats count by host, user, Image, CommandLine
```

### KQL Queries
```kql
// Tomcat Backdoor network detection
DeviceNetworkEvents
| where RemoteUrl contains "tomcat" or RemoteUrl contains "c2"
| project Timestamp, DeviceName, RemoteUrl, InitiatingProcessFileName

// Tomcat Backdoor process detection
DeviceProcessEvents
| where ProcessCommandLine contains "tomcat" or FileName contains "tomcat"
| project Timestamp, DeviceName, FileName, ProcessCommandLine
```

## IOCs (Indicators of Compromise)

### File Indicators
- **File Names**: [Known Tomcat Backdoor file names from threat intelligence]
- **File Hashes**: [Known Tomcat Backdoor file hashes from threat intelligence]
- **File Locations**: [Known Tomcat Backdoor file locations from threat intelligence]

### Network Indicators
- **C2 Domains**: [Known C2 domains from threat intelligence]
- **IP Addresses**: [Known C2 IP addresses]
- **Ports**: 80, 443 (HTTP/HTTPS)

### Behavioral Indicators
- **Process Names**: Suspicious process names
- **Registry Keys**: Unusual registry modifications
- **File Paths**: Suspicious file creation patterns

## Mitigation Strategies

### Prevention
- **Endpoint Protection**: Deploy EDR solutions with web shell detection
- **Network Monitoring**: Monitor for suspicious network connections
- **Access Controls**: Implement strict access controls
- **Patch Management**: Keep systems updated with latest security patches

### Detection
- **Network Monitoring**: Monitor for suspicious HTTP/HTTPS traffic
- **Process Monitoring**: Monitor for suspicious process creation
- **Registry Monitoring**: Monitor for suspicious registry modifications
- **File System Monitoring**: Monitor for suspicious file operations

### Response
- **Incident Response**: Have procedures for web shell incidents
- **Forensic Analysis**: Preserve evidence for investigation
- **System Recovery**: Use clean backups for system recovery
- **Credential Rotation**: Rotate potentially compromised credentials

## Related MITRE ATT&CK Techniques

| Technique | Description | Tactic |
|-----------|-------------|---------|
| T1055.001 | Process Injection: Dynamic-link Library Injection | Defense Evasion |
| T1071 | Application Layer Protocol | Command and Control |
| T1071.001 | Application Layer Protocol: Web Protocols | Command and Control |
| T1071.004 | Application Layer Protocol: DNS | Command and Control |
| T1218.011 | Signed Binary Proxy Execution: Rundll32 | Defense Evasion |
| T1547 | Boot or Logon Autostart Execution | Persistence |
| T1560 | Archive Collected Data | Collection |
| T1573 | Encrypted Channel | Command and Control |

## References

- [CISA Alert - Web Shell Threats](https://www.cisa.gov/news-events/cybersecurity-advisories/)
- [MITRE ATT&CK - Tomcat Backdoor](https://attack.mitre.org/software/)
- [FBI Guidance - Web Shell Threats](https://www.fbi.gov/)
