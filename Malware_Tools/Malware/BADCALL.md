---
title: BADCALL
type: malware
importable: true
exportable: true
last_reviewed: 2025-01-20
mitre_ids: ["T1071", "T1071.001", "T1071.004", "T1090", "T1547", "T1560", "T1562.004", "T1573"]
---

# BADCALL

## Overview

BADCALL is a sophisticated proxy malware developed by North Korean state-sponsored threat actors. This malware is designed to turn compromised systems into relay nodes, enabling threat actors to bypass network restrictions and disguise their operations by relaying traffic through victim systems.

## Observed Behavior & Capabilities

### Primary Functions
- **Proxy Functionality**: Creates proxy tunnels through compromised systems
- **Traffic Relay**: Relays C2 traffic through victim networks
- **Network Pivoting**: Enables lateral movement through network segments
- **Traffic Obfuscation**: Hides C2 traffic within proxy chains

### Key Capabilities
- **FakeTLS Protocol**: Implements fake TLS handshakes to evade detection
- **Firewall Modification**: Modifies Windows Firewall to allow inbound connections
- **Port Binding**: Binds to specific ports (443, 8000) for C2 communication
- **Encrypted Communication**: Uses encryption for C2 communications

## Technical Details

### Architecture
- **Type**: Proxy Malware
- **Platform**: Windows-based systems
- **Communication**: HTTP/HTTPS and FakeTLS protocols
- **Persistence**: Various persistence mechanisms including service installation

### Network Behavior
- **Protocols**: HTTP/HTTPS and FakeTLS for C2 communication
- **Default Ports**: 443, 8000 (configurable)
- **Encryption**: May use encryption for C2 communications
- **Beaconing**: Regular beaconing to C2 infrastructure

## Detection Methods

### Network Detection
```suricata
# BADCALL C2 Communication
alert tcp any any -> any any (msg:"BADCALL - C2 Communication"; content:"|BADCALL_MAGIC_STRING|"; flow:established,to_server; sid:2025104028; rev:1;)

# BADCALL HTTP C2
alert http any any -> any any (msg:"BADCALL - HTTP C2 Communication"; http_uri; content:"/c2"; sid:2025104029; rev:1;)

# BADCALL FakeTLS
alert tls any any -> any any (msg:"BADCALL - FakeTLS Communication"; tls.sni; content:"suspicious_domain"; sid:2025104030; rev:1;)
```

### Host Detection
```powershell
# BADCALL process detection
Get-Process | Where-Object {$_.ProcessName -match "badcall" -or $_.CommandLine -match "badcall"}

# Suspicious service creation
Get-Service | Where-Object {$_.Name -match "badcall" -or $_.DisplayName -match "badcall"}
```

### Behavioral Indicators
- **Network Connections**: Unusual outbound HTTP/HTTPS connections
- **Process Creation**: Suspicious process creation patterns
- **Registry Modifications**: Unusual registry modifications
- **File System Changes**: Suspicious file creation and modification

## Hunting Queries

### Splunk Searches
```splunk
# BADCALL network activity
index=network* (url="*c2*" OR url="*badcall*") OR (dest_port="443" OR dest_port="8000")
| stats count by src_ip, dest_ip, url, dest_port

# BADCALL process activity
index=sysmon* EventCode=1 (Image="*badcall*" OR CommandLine="*badcall*")
| stats count by host, user, Image, CommandLine
```

### KQL Queries
```kql
// BADCALL network detection
DeviceNetworkEvents
| where RemotePort == 443 or RemotePort == 8000 or RemoteUrl contains "badcall"
| project Timestamp, DeviceName, RemoteUrl, RemotePort, InitiatingProcessFileName

// BADCALL process detection
DeviceProcessEvents
| where ProcessCommandLine contains "badcall" or FileName contains "badcall"
| project Timestamp, DeviceName, FileName, ProcessCommandLine
```

## IOCs (Indicators of Compromise)

### File Indicators
- **File Names**: [Known BADCALL file names from threat intelligence]
- **File Hashes**: [Known BADCALL file hashes from threat intelligence]
- **File Locations**: [Known BADCALL file locations from threat intelligence]

### Network Indicators
- **C2 Domains**: [Known C2 domains from threat intelligence]
- **IP Addresses**: [Known C2 IP addresses]
- **Ports**: 443, 8000 (configurable)

### Behavioral Indicators
- **Process Names**: Suspicious process names
- **Registry Keys**: Unusual registry modifications
- **File Paths**: Suspicious file creation patterns

## Mitigation Strategies

### Prevention
- **Endpoint Protection**: Deploy EDR solutions with proxy tool detection
- **Network Monitoring**: Monitor for suspicious proxy connections
- **Access Controls**: Implement strict access controls
- **Patch Management**: Keep systems updated with latest security patches

### Detection
- **Network Monitoring**: Monitor for suspicious HTTP/HTTPS traffic
- **Process Monitoring**: Monitor for suspicious process creation
- **Registry Monitoring**: Monitor for suspicious registry modifications
- **File System Monitoring**: Monitor for suspicious file operations

### Response
- **Incident Response**: Have procedures for proxy tool incidents
- **Forensic Analysis**: Preserve evidence for investigation
- **Network Isolation**: Isolate compromised systems
- **System Recovery**: Use clean backups for system recovery

## Related MITRE ATT&CK Techniques

| Technique | Description | Tactic |
|-----------|-------------|---------|
| T1071 | Application Layer Protocol | Command and Control |
| T1071.001 | Application Layer Protocol: Web Protocols | Command and Control |
| T1071.004 | Application Layer Protocol: DNS | Command and Control |
| T1090 | Proxy | Command and Control |
| T1547 | Boot or Logon Autostart Execution | Persistence |
| T1560 | Archive Collected Data | Collection |
| T1562.004 | Impair Defenses: Disable or Modify System Firewall | Defense Evasion |
| T1573 | Encrypted Channel | Command and Control |

## References

- [CISA Alert - North Korean State-Sponsored Threats](https://www.cisa.gov/news-events/cybersecurity-advisories/)
- [MITRE ATT&CK - BADCALL](https://attack.mitre.org/software/)
- [FBI Guidance - North Korean Cyber Threats](https://www.fbi.gov/)
