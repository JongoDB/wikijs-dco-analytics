---
title: ScanLine
type: tool
importable: true
exportable: true
last_reviewed: 2025-01-20
mitre_ids: ["T1003", "T1033", "T1046", "T1059.003", "T1071.004", "T1547"]
---

# ScanLine

## Overview

ScanLine is a lightweight command-line port scanner originally developed by Foundstone (now part of Rapid7). While it has legitimate uses in network administration and penetration testing, it is frequently repurposed by threat actors for internal network reconnaissance and lateral movement planning.

## Observed Behavior & Capabilities

### Primary Functions
- **Port Scanning**: Rapid port scanning of target networks
- **Network Reconnaissance**: Mapping internal network infrastructure
- **Service Detection**: Identifying open services and potential attack vectors
- **Stealth Operation**: Lightweight, self-contained executable

### Key Capabilities
- **High-Speed Scanning**: Multi-threaded scanning for rapid network mapping
- **Protocol Support**: TCP and UDP scanning capabilities
- **Banner Grabbing**: Service identification through banner collection
- **Output Generation**: Text file output for analysis and exfiltration

## Technical Details

### Architecture
- **Single Executable**: Self-contained 24KB executable (ScanLine.exe)
- **No Installation**: Requires no installation or additional dependencies
- **Command Line Interface**: Operates entirely through command line arguments

### Usage Patterns
```bash
# Common ScanLine usage patterns
scanline -t 20 -u -p 1-1024 10.0.0.0/24
scanline.exe -p 1-65535 10.10.10.50 > C:\Temp\10.10.10.50_ports.txt
```

### File Characteristics
- **File Size**: Approximately 24KB
- **Packing**: May be UPX-packed by threat actors
- **Naming**: Often renamed to avoid detection

## Detection Methods

### Network Detection
```suricata
alert tcp $HOME_NET any -> $HOME_NET any (msg:"ScanLine Port Scan Detected"; threshold:type both,track by_src,count 50,seconds 60; sid:2025100610; rev:1;)
```

### Host Detection
```powershell
# PowerShell detection for ScanLine execution
Get-Process | Where-Object {$_.ProcessName -match "scanline"}

# Check for ScanLine files
Get-ChildItem -Path "C:\" -Recurse -Filter "scanline.exe" -ErrorAction SilentlyContinue
```

### Behavioral Indicators
- **High Port Scan Volume**: Rapid scanning of multiple ports
- **SYN Flood Patterns**: High volume of SYN packets
- **DNS PTR Lookups**: Burst of reverse DNS lookups
- **File Creation**: Creation of output files in temp directories

## Hunting Queries

### Splunk Search
```splunk
index=win* (EventCode=4688 OR EventID=1) NewProcessName="*\\ScanLine.exe"
| stats count by host, user, NewProcessName, CommandLine
```

### KQL Query
```kql
DeviceProcessEvents
| where ProcessCommandLine contains "scanline" or ProcessCommandLine contains "-p "
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
```

## IOCs (Indicators of Compromise)

### File Hashes
- **MD5**: 3a97d9b6f17754dcd38ca7fc89caab04 (UPX-packed variant)
- **File Names**: ScanLine.exe, sl.exe, scanline.upx

### Command Line Patterns
- `-t` (threads parameter)
- `-p` (ports parameter)
- `-u` (UDP scanning)
- Output redirection to files

## Mitigation Strategies

### Prevention
- **Application Control**: Implement application whitelisting to prevent execution
- **Network Segmentation**: Limit internal network access
- **Monitoring**: Deploy network monitoring solutions
- **User Training**: Educate users about suspicious network tools

### Detection
- **Endpoint Protection**: Deploy EDR solutions with port scanner detection
- **Network Monitoring**: Monitor for port scan patterns
- **File Monitoring**: Monitor for creation of suspicious executables

### Response
- **Incident Response**: Have procedures for reconnaissance incidents
- **Network Isolation**: Isolate systems showing scan activity
- **Forensic Analysis**: Preserve evidence for investigation

## Related MITRE ATT&CK Techniques

| Technique | Description | Tactic |
|-----------|-------------|---------|
| T1003 | OS Credential Dumping | Credential Access |
| T1033 | System Owner/User Discovery | Discovery |
| T1046 | Network Service Scanning | Discovery |
| T1059.003 | Command and Scripting Interpreter: Windows Command Shell | Execution |
| T1071.004 | Application Layer Protocol: DNS | Command and Control |
| T1547 | Boot or Logon Autostart Execution | Persistence |

## References

- [Foundstone ScanLine Documentation](https://www.foundstone.com/)
- [CISA Alert - Volt Typhoon](https://www.cisa.gov/news-events/cybersecurity-advisories/)
- [MITRE ATT&CK - Network Service Scanning](https://attack.mitre.org/techniques/T1046/)
