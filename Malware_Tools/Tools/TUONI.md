---
title: TUONI
type: tool
importable: true
exportable: true
last_reviewed: 2025-01-20
mitre_ids: ["T1003", "T1071", "T1071.001", "T1218.011", "T1547"]
---

# TUONI

## Overview

TUONI is an open-source red teaming command-and-control (C2) framework comparable to Cobalt Strike. This Java-based framework enables users to generate payloads, establish asynchronous C2 over multiple channels, and manage compromised systems through a web-based GUI interface.

## Observed Behavior & Capabilities

### Primary Functions
- **Command and Control**: Provides persistent C2 infrastructure for red team operations
- **Payload Generation**: Creates various payload types for target deployment
- **Multi-Channel Communication**: Supports HTTP/HTTPS and other communication protocols
- **Web-Based Management**: Offers a web GUI for operator management

### Key Capabilities
- **Java-Based**: Built on Java with Docker deployment options
- **Plugin System**: Modular architecture allowing additional capabilities
- **Multi-Platform**: Supports various target platforms
- **Encrypted Communication**: Uses encryption for C2 communications

## Technical Details

### Architecture
- **Type**: Command and Control Framework
- **Platform**: Java-based with Docker deployment
- **Communication**: HTTP/HTTPS with support for multiple protocols
- **Persistence**: Various persistence mechanisms for deployed agents

### Network Behavior
- **Protocols**: HTTP/HTTPS for C2 communication
- **Default Port**: 12702 on server side
- **Encryption**: Framework likely encrypts C2 traffic
- **User Agent**: May use Java default User-Agent or custom agents

## Detection Methods

### Network Detection
```suricata
# TUONI C2 Communication
alert tcp any any -> any 12702 (msg:"TUONI - C2 Communication"; flow:established,to_server; sid:2025104008; rev:1;)

# TUONI HTTP C2
alert http any any -> any any (msg:"TUONI - HTTP C2 Communication"; http_user_agent; content:"Java/"; sid:2025104009; rev:1;)
```

### Host Detection
```powershell
# TUONI process detection
Get-Process | Where-Object {$_.ProcessName -match "tuoni" -or $_.CommandLine -match "tuoni"}

# Java process with TUONI indicators
Get-Process | Where-Object {$_.ProcessName -like "*java*" -and $_.CommandLine -match "tuoni"}
```

### Behavioral Indicators
- **Java Processes**: Unusual Java process behavior
- **Network Connections**: Outbound connections to port 12702
- **Docker Containers**: Suspicious Docker containers named "tuoni"
- **Web Traffic**: Suspicious web traffic patterns

## Hunting Queries

### Splunk Searches
```splunk
# TUONI network activity
index=network* (url="*tuoni*" OR port="12702") OR (user_agent="*Java*" AND dest_port="12702")
| stats count by src_ip, dest_ip, url, user_agent

# TUONI process activity
index=sysmon* EventCode=1 (Image="*tuoni*" OR CommandLine="*tuoni*" OR Image="*java*" AND CommandLine="*tuoni*")
| stats count by host, user, Image, CommandLine
```

### KQL Queries
```kql
// TUONI network detection
DeviceNetworkEvents
| where RemotePort == 12702 or RemoteUrl contains "tuoni"
| project Timestamp, DeviceName, RemoteUrl, RemotePort, InitiatingProcessFileName

// TUONI process detection
DeviceProcessEvents
| where ProcessCommandLine contains "tuoni" or FileName contains "tuoni"
| project Timestamp, DeviceName, FileName, ProcessCommandLine
```

## IOCs (Indicators of Compromise)

### Network Indicators
- **Default Port**: 12702
- **Protocols**: HTTP/HTTPS
- **User Agents**: Java default User-Agent patterns
- **Domains**: Suspicious domains hosting TUONI infrastructure

### Behavioral Indicators
- **Process Names**: Suspicious Java processes
- **Docker Containers**: Containers named "tuoni"
- **File Paths**: Suspicious file creation patterns
- **Registry Keys**: Unusual registry modifications

## Mitigation Strategies

### Prevention
- **Endpoint Protection**: Deploy EDR solutions with C2 detection
- **Network Monitoring**: Monitor for suspicious network connections
- **Access Controls**: Implement strict access controls
- **Patch Management**: Keep systems updated with latest security patches

### Detection
- **Network Monitoring**: Monitor for suspicious HTTP/HTTPS traffic
- **Process Monitoring**: Monitor for suspicious Java processes
- **Docker Monitoring**: Monitor for suspicious Docker containers
- **File System Monitoring**: Monitor for suspicious file operations

### Response
- **Incident Response**: Have procedures for C2 framework incidents
- **Forensic Analysis**: Preserve evidence for investigation
- **System Recovery**: Use clean backups for system recovery
- **Credential Rotation**: Rotate potentially compromised credentials

## Related MITRE ATT&CK Techniques

| Technique | Description | Tactic |
|-----------|-------------|---------|
| T1003 | OS Credential Dumping | Credential Access |
| T1071 | Application Layer Protocol | Command and Control |
| T1071.001 | Application Layer Protocol: Web Protocols | Command and Control |
| T1218.011 | Signed Binary Proxy Execution: Rundll32 | Defense Evasion |
| T1547 | Boot or Logon Autostart Execution | Persistence |

## References

- [TUONI GitHub Repository](https://github.com/shell-dot/tuoni)
- [BorderGate Security - TUONI Analysis](https://www.bordergate.com/)
- [Malpedia - TUONI](https://malpedia.caad.fkie.fraunhofer.de/details/win.tuoni)
